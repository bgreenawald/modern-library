---
import Layout from '../../layouts/Layout.astro';
import BookDetail from '../../components/BookDetail.astro';
import DownloadsTable from '../../components/DownloadsTable.astro';
import VersionsGrid from '../../components/VersionsGrid.astro';
import { generateBookPaths } from '../../lib/paths';

export async function getStaticPaths() {
  return generateBookPaths();
}

const { book, versions, hasVersions, latestVersion, latestRelease } = Astro.props;
---

<Layout title={book.data.title}>
  <main class="container mx-auto px-6 py-16 md:py-24">
    <BookDetail book={book} />

    <!-- Latest Version Downloads -->
    {latestRelease && (
      <DownloadsTable 
        release={latestRelease} 
        version={latestVersion} 
        title="Latest Version Downloads" 
      />
    )}

    {hasVersions ? (
      <VersionsGrid versions={versions} bookSlug={book.slug} />
    ) : (
      <section class="text-center">
        <p class="text-lg">No versions available for this book yet.</p>
      </section>
    )}
  </main>
</Layout>